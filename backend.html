<!doctype html>
<html>

<head>

<style>
.user { 
    border: 1px solid black;
    float: left;
    margin: 5px;
    padding: 5px;
    word-wrap: break-word;
}
</style>

<link rel="stylesheet" src="/node_modules/bootstrap/dist/css/bootstrap.min.css">

</head>

<body>

    There are <span id="TotalUsers"></span> total users.<br>


    <div id="users"></div>


    <script src="socket.io/socket.io.js"></script>
    <script src="/node_modules/raphael/raphael-min.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
    $(function() {	
    var socket = io();

    socket.on('update info', function(info){
        $('#users').append('<div id='+info.id+' class="user"></div>');
        $('#'+info.id).append($('<div>').text(info.hosts));
        $('#'+info.id).append($('<div>').text(info.referrers));

    for (var n in info.creatives) {

        creative = info.creatives[n];

        $('#'+info.id).append(creative.id+'<div id='+creative.id+' class="visible"></div>');
        $('#'+info.id).append($('<li>').html("Bid: " + creative.pm_bid));
        $('#'+info.id).append($('<li>').html(creative.tag)); 
    }
      });

    socket.on('update backend visible', function(info){
    for (var n in info.creatives) {
        creative = info.creatives[n];
        $('#'+info.id + ' #'+creative.id).text("Visible: " + creative.visible);
    }
      });

    socket.on('userJoined', function (data) {
        console.log('A user joined with id #' + data.id);
        $('#TotalUsers').text(data.total - 1);
    });

    socket.on('user left', function (data) {
        $('#TotalUsers').text(data.susers - 1);
       $('#' + data.suid).remove();
        console.log('A user disconnected with id #' + data.suid);
    });
});

    </script>

  
</body>

</html>
